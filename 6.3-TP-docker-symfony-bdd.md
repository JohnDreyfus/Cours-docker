# Symfony dans docker

- Avec ce Dockerfile, essayez de faire tourner votre projet symfony vu en cours.
- Ajouter le Dockerfile a la racine de votre projet symfony.

- Essayer en suite de rajouter une base de données Postgres pour intéragir avec votre app

```Dockerfile
FROM php:8.3-cli-alpine

ENV APP_ENV=dev \
    COMPOSER_ALLOW_SUPERUSER=1

WORKDIR /var/www/html

# Dépendances système
RUN apk add --no-cache \
    git bash icu-dev libzip-dev zip unzip \
    oniguruma-dev libpng-dev libjpeg-turbo-dev freetype-dev \
    linux-headers $PHPIZE_DEPS

# Extensions PHP
RUN docker-php-ext-configure gd --with-freetype --with-jpeg \
    && docker-php-ext-install -j$(nproc) intl pdo pdo_mysql zip gd opcache

# Xdebug pour le développement
RUN pecl install xdebug \
    && docker-php-ext-enable xdebug

# Composer
COPY --from=composer:2 /usr/bin/composer /usr/bin/composer

# Optimisation du cache Docker
COPY composer.json composer.lock symfony.lock* ./
RUN composer install --no-dev --no-scripts --no-interaction --prefer-dist

# Reste du projet
COPY . .
RUN composer install --no-interaction

# Permissions (ajustez l'UID selon votre système)
RUN chown -R www-data:www-data /var/www/html/var

EXPOSE 8000

# Ou si pas de Symfony CLI:
CMD ["php", "-S", "0.0.0.0:8000", "-t", "public"]
```